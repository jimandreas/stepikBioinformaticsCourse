@file:Suppress("SameParameterValue", "UnnecessaryVariable", "UNUSED_VARIABLE")

import util.hammingDistance

// 1.8 Some Hidden Messages are More Elusive than Others

/**
We say that a k-mer Pattern appears as a substring of Text
with at most d mismatches if there is some k-mer substring Pattern' of Text
having d or fewer mismatches with Pattern, i.e., HammingDistance(Pattern, Pattern') â‰¤ d.
Our observation that a DnaA box may appear with slight variations leads to the following
generalization of the Pattern Matching Problem.

Approximate Pattern Matching Problem: Find all approximate occurrences of a pattern in a string.

Input: Strings Pattern and Text along with an integer d.
Output: All starting positions where Pattern appears as a substring of Text with at most d mismatches.

Code Challenge: Solve the Approximate Pattern Matching Problem.

Extra Dataset

Debug Datasets

Sample Input:

ATTCTGGA
CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAAT
3

Sample Output:

6 7 26 27
 */

fun main() {
    val genome2 = "CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAAT"
    val target2 = "ATTCTGGA"
    val mismatches2 = 3

    val examGenome = "TAGGAAGACACAACGGCTTGTTATGTCACAAGGAAAGCAGACAAAGCGGAACCATTACAACACAAGTCCCGGAACGGACTTGGTACCGGGTTAAACAGGTAGATTCATCGTCGTTTCCCCCATGAGGGTATAGCGTTAGTGTGCTCCAAGGTCGTGTAGCGTAACTGAGTAGTATCGTCCGCATGCCGGATCTTGTAATGCTACGCCATAATAACGCCTGCCCCGAGTGGCGCCCTACAACCGGAAGGGGGGAGTCTGATTACACGGGACGACCGAACGGTAGTTCTTATCATTGCAATTGATTTTGCTGGATTTGGTGCTTTAGACCCCATTTCTGAGTTTGCTACGGGTACTGCACCTATGTCGGGTGAGCGGTGTAACCACCTGCATTCGTAACACCTAATCCCCCGGTGACATATTTAGGCCGCGGGATACAGAGAAGAAACACTCAAGGCGAGGGTCTCGCCGCGAAGACTTCCCCAGAACACCACAGAAACATGTCGGCCCTCAATGTCCTTGAGTGTGCTGGCGTCAGCTAATGGATGATCTCACGTAGGGCCGGTATAACAGCAATCTAAATCTATTATTGCACGTGGTGAATTGAGTTAATTATATGTAGACCGCTTCGTAATCCGGTTTCGGATAAATTCCCCAAAGTCCTACCGCGACGTCTCCAAGGTTCTTGCGCTATAAAGGGACGCCGTCACAGGAGTCGTCACGTGGTCAAACATACTGCGTTGCCGATCTATCGGGCTTGACGAGCGCTTTCTAATAATTCTCTCTCTGATAACAACCTCGCGGTGATACTCGTCCTCCGACCCGTCTCCCAGTCCGGAACATAGGACTACATCATGGGGAAAGGGTCGCTAGGACTTCAACAAACTCTTGTCTCGTAGTAGTTACAAGCAAGTCATAGGTGAGCTCGGCCAGGAGTTAATCCATACTTCCCCTTTTACTGATGTACCCAGTCCGCCCGGTTTCTAACTCGCCGAGAAAACATAATCGGCGTGAATTGCTCTCCAGCCGGTGGAGCCGCCCGGACACTGAGGGCTCACCAGATCGAAAACATCCGATCTGATAGCGACGGAAAGGATTCGGAGTGTCTCTCCACGTAGGTCCCGGTGCGATTAGTCGGCTGGGGTGAGGAGTACGCAAGCGGTAGCCTAAACACTCCAGCCAGACTAAGGCTTGGGTAGCAGGAACTACGCGCACTCGGGTCTTGCTTTATCCCGAGAAAGAAGGCGAACGCTGACAAGAAGGGAAGTGCATGCTCCGTTCTGTACGCCTTTGCTAATTGCTTTTGAAATTCGTGCTAGCTTACAGGCAGAGCACGTGTGATTTGAGTTATAGGGACCGCATTGGTAGACGGACGACTATACCATTCCACGCACATTCAAACGTATTGTTAGCGATTCAGGAGGCGCGGCGCCGATAAGTGACTGCCGGGATAACGGTGTTCAATGTCACACTATAAGGACATGTGTGCTCAGGATCTATGCCCAAATCAATTTACAATCTGATTGCCGCTGGACACTATCGGGCCATGTAACACACCAGCTTCAAGATGTAGCAGATGGCCATGTAACGGAAGGCTCACACCTATCAAGGCGCGTAGGTATTGGCTAATGCCAAGTATAGAGGCCGTCCGTCTCCACACTATGGTGTGCAAACTTAGCGCGGCACAACACCACTCAAGCTATGGGTAGGCCTGTGCCTTTTCTTAGTAGTCAAATGAGACCATCACATTGCGAGGGAGTCGACGGCGGATGAGTACGGGGGTCCGAGCATGCGTTCGGCGGCGAACACCAGCTGACCCATACAGTAAATGCCAGCATGGACGCAAGTTAGTGCGCCCACTGGTCAGCATCCCTTCGAATTTCGTAGCTTCGATTTTGATCCAGGCTACCTCCGTCGGACAGATCACGCGATCAGGTCGCAGCCAAACGGCGTACTTGGAAACTCTGTGCGCCTCCTCTTTTCTTGACATTCAGTGCTTGCAAGCATCGACATGTATGCTGCTTTGCGAGCAGCTTGTCAATTTTTGTCGAGACCTGATAGAGGACTCAGGACCCGCCATTTACACAGCGAGATGTGTTTGTGTACCTCTTACACCGTCCACTGCCTGGCGAGAGCCCGGGATGGTTCGCCCCTGAGGTATGCAAGCGTCCAAGGCCTAATGCACGCTAAGCCATCCTTATCTACGGACATCCAACACTTCTGCGCCCATTATATCGTGGGAAGAACCGTTGCCCGAAGCAGATGTCGTAGAGAACCCACAGGTTAAGGGCCGGTTGCTCTAGTGTAGAGCGAGCCAAGAGCTCATTTCGTCTGGGTGCAAGATTTCTATACGCATACTCTCGCAAACTTATGAAGAGTATATCTCACGAGGCTCTCGGTCACTAGACCGCAATGCAAGTGTTATATTTCGATAATGCGCACTGCACAAGAACTTATGCATCTCGACTTCCCGATCGTTCCTATCACGTCCGAAGTGGGTCGATGGTAGTAAACTAGCGGCTTGTATACCATGGTAAAAAGAGGACTTGGAAGGTTATTATTAGGCTCTAATCAGAACCACCCGTAACAGACGCAGTTCTTATCCGTGGCTTGTAGGTCGCTTAGCCGAATTATAATATTCACCGGTTACGTTGAGGCATTTATCCACTCTAAATGGATATAGTCAGAGGTTGCTTGAGGAAATGATGTTCCCGGAGGCGTAGAGAAAGCGGTGTAAGACGAAGGGAGAGCACTCTCTATGCCGATTAGGCAGTCTGGACCGCAGTCTTCAGCTGCTTTATCCAGCCTACGGCCATGACCCGAAGTGACCCTAAACTCGAAATCTTACTGCTGCGGGGGGCCGCGTGCGCCATGACGTACACGTACAACTAGCATAAAGGATAGAGGTGGCGCCACCTTTGCCTTCGAAAAGGTTTAGCTCTTTACCTACGCTTTGCTATTTAGCACGCCGCGTCACCGCTCTGAGGGTCTCCTAATGCCTCTGAATAGCCTCCTGAGTGGTCTCGCTCCTGTGTGGTTCCGGGGACCCCTTCAGACTTCCGGCCTACGCGGCTTAAGCTTCGTCGACTTCGCATCGCCAGCGGTGTGGCATATTTCCCTCATGCAAGATGTGGCAGGCGCAATGTATTGGGCCAGAGAGTGTTTACAGTTCCCGATGCTTACACTTATGACGATGTCTCTTGAAGTGGTCCATGACCACAGTGGATGTTATCCCCGGATCGAGAATATAACATGTATTAACCCCCAACGGTCGCGTCGTCCACTCCTATACCAACTGACCGGACACCGGTGAGTGGCTAGAGTCACTGATCAAGAGGTGCACCTCTTGATCCCGACTGGACGCATAGCCGAGGGTGAGTGTGGTTAACGCTCGAGAGCAATGTGACCACAAATCAAGCCTTGGCAACACAGGTTTCGTAGAAAGGGGCTTCAAAGTGCACTAGCATCAAGGGATAATTTTGTTCCCTCTATGTTCATTACCATACATTCTTTGCTACGCTGGCAGCGACTCCTCGCGGGCCCCTATGAGCGGTGTGAATAGAATCCGTACTTATGGACTTCACTTCCCTAACGATGGTATAGCTCTCCTCTCTATCAAGGTAACGTAGCGTGTCATGCTATAACCTACCGTGAGTCAAGTATTTGGGCTGTACTGCGTGGCTGTACCTTCAGGCGTGACCTTGGCTTATCCTTGAAGGTGTCACTCGTGTGTGGCACCGCGCCAGCGGAAACCTTGTTGGGGAGGGTATATCTCGAAGAGAAAGATCCTCTACTAAGGACTATGGCCCGCCCTGGATACCCTGGTACATAACAATGCCCCAGCGAATGCTTTGCAAGAGAGGCTCTTGGCCTCATGTCCCACATCCAACGCTAAGCGATCTCGCGGGTCTGGTCTGATGACCCGTACGACCTGGTTCCCAAGACAACAAGTGCTCCAGCAAATTAATAGGCGGCGTGGAATAACCGGACCTGGCAGATGATTCCTGGAGAGATAGAATCCGAACACTTATACGCTATTCTACCGCAGATCTAGCATCGTGGATAGAGCTGGTAAGTGGATAGTCCACGGGGCGAGGGACGCGTACTGTCGACTGTAACCCATTAACACCACCCGCCAGAGGTAGAGTCTATTATTCCGAAAGACGAAATATCGTACTCCTCTAAGTAATTAGAACTCGAGGGCAAGGAAATAATAACTCTGGGCTTACTCCCTAGCGTCCTGTTGTGTATGGACAGTCCACTGTAGGGGAACTCTATGATGGTGGCCCCTACACTTTCGGTAAGTACGGGTCAACATGGCCTTAACATTCGTGATTTAACCGTCCGTTTATGTGGTCATGGGGGTGTTGGGTTGGGCTGGTGCTGCTCGATGATACAGTTCACCGCTTCGTGAGAATCTCATTGGGTTCCACATAATTGGATGTAGACAGCCGCTATGAGAAGATGCTAGAGCTTCGATAAGTTATACTCGAACGCGCTTGGTTACTCCGCAGTTTACGACCGGTGACCGAACTCCCCACCAACCATCATTATCGTGCTCCGAAACTCAGTAGTCCTCTATCCGCAACTCACCTGATCTCGTTCCCGGCCCGTCTTACTCAGGCAAACAGCTGGTAGGTCGAAAGGTCTATGACCTGATTACTACGCAGGAGAAGACCTGGGAACCTGTGCCATCGTGCCATATTGTTTCGACACTGAGTCGGGGAGCTGGTAGGGCCCGATCTTTACCATACTTGGACTCTAGCGTCAGAAAATAGTATTTGGACTAGCGATCAGCGATAGAGGTTTCTCTGCAGCAGTCTTCACGATTCACATGCCCTACACTGAGGGCGACAATCATAATTACGAACCCAGGCCGCTGGTATGTACACAAACGTAGGACCCTCTCAGCCGTCCTTAATGCGCTCATTTTGGAATGGAGGGACAGGGAGTTCTCTCTTATGCGAGAACCACGGTTCATCGACTACTCTGTATACAAAAGTCGGGCCATATTAGGAGGCCCGAGTCTCATAAGCTCGAATCGTCGCTTTGCGCATTGGACGCGGGGTTTAAGAGCTTACACCTGGACTCACTTACTGCTAGCTGTATGGGGCCACATCAGAGATGGAAAAATTGTGTGTCGCACTGGGTCGCGGGGTTGGCGTGTGAGAAATAGTCGGATGACACCACCCTCGGGGAAACGCACTTGGGGCAGCACACACTAACCGTAGTACTCGAGCGATCACACGCGACAAGGTGCGAAACTTCAGCAGTCTAGACATCCCTGGTACTGCTGGGCGAGTAAAATCATGCAGGAGGCATTCTCTCAAACAAGAACCCCAACCACCCCTTTCGCATAAGACAAATCGCTTGACGTAACGCGTTTGTTCGACAACCATTTTGCACCTGTACGCTGCACAACCGTCAGCCATGGATGATTGTACCGATCTACCTCGGTGATGAGTGCATGAGATCACCATCCATCCAACATGAGGATCTTTCACTTGGATTATTAATGCCTCTTTTGAGCGACCGTACATTCGGAGCCATAAGATTGGTTGAAACCCTCCTTTGGTGGAACGGAATAACTGTCTTGGGATCTTGTGTCCCCGACCGTCCCGGATAGACAACCCTCACGGTCTAGTGAATGGTGAAGCGGATAGGAGGGTTACTGCCTCCCGGTACATAACGATTTTATAGACAACTATGTTAAACTCAGGCGCGGAACTGACTCTCCAGTACGACGCGTTGGCCGTATGCCCGTGCTACTGTGATATACCATCTGAACCGTAGAAACACTTCTTCTGAATAGTCCGGATTTCAACGACCGTTACAGGTTTGAATGTTGCGCGGTCGTCATCGAAGGATCTGGAGCGCCCATGGCACCTTGGTAAGGCGTGACAGAGGAATAGAGAAATGTGACCGAACTACTTGCATCTAAACTCGGCGGATGAGAATTAGCGGTCGAAATAGTACCGTCCAGCTCGCGCGCGCGGACCTCACACGAAAAAGAGTGAGCGAGTCGATTAGTATGCAAAGCTATCGCCGTCAGTTAAGCTACATAGGTGCTGAGGTAAGCGGCAATCGCGGGACAATCCAACACTCGTTTCCCCTGCAAGATGCCCTCCCAGGTACTCCAGGTGGGGACACTCGTAAAGGTCAGACATCGCTGGCTTACAGTGTGTTTTTCCACATTCCAGACGATACTTCTCTGTAGATTTTCGCCTTAGTACAACCAGGCTGATGATAAGGACTTGATACTTGATTGCTGGAAAATGTGGTCGTCAGAGCACCGTACGGTGGGCTCGGGAACTAATTGTGGATCACTCTAACGAGAGTTACGCCGTCATTTTAAATCTGATAAGCGATCCATTTGCTATACTGCTCGTGGACAGATGGCGGTCCCGTAACTGCATAAGCTAAAAAGTAAGGCGTAAACTTCGATAAACACATAGATAAGATCCTCGGCAGCGATATCCTGGCTGCATGGGAGCAGCGCACAGGAACGAGTTCGGAGATAGTCCGCTTAGACACGATTAGCCAGCGGTTGTTAGAGATATAAATCCTGATGGGACGTTACGCGAGCCAGCGTCCGTACTGCGGGTTTGCGCGTGATTCCCACATTATTGGACCAGACCCGAGGGTCGATAGACCAGAGTATACTGACTGAGCTCCAGAACGCGGGACTAGTCAGACACGAAGGGAGCATTTGTTGAGCGTTGTTAAAGTCATATGGCGTTGATCACTTGCCATTAGTTGCGTGCTGGGCCGAAAGAGATCGGCTGCCCGATGCGGTGTCACGCCGTATAGCCGTACAAGAAGCCCTATCCCGGTTGAGAACTGGTTAGGCGGTGACCTGAGTATTTGCATGGCCAGCCTGCGAGCAACGTAATGCGAGGTGAGTCCCAATTTCAGTAGCCAATCTACGCTATGGCTTGGAAGCTCGGCAGCTCGTATAAGAAAGCGAACCAGGGTACGTGTCAACACACGCCCGAGATTAACACACCTAATCAGGGGGAGTATCGGGAATGAGACACATTTGTCCCTCAGCCTGATTTCGAATCTGTCGACGTCCCTCCGAAGCGCCAACTGTCAAGAGGGGGCTTTCCTAATAGGACATCTTACACGGAAAGAGAGGCTTATGGAGCATCATACCGCTTTTGAGTAAGAATGTGTCACTTTTGGTGTATCGCTTCCGTCCTGTACAGTACGCTCAACAGCTCGCGAGCGAGTCTTTGTGTCACATCAATCTGGTGTATGTGGTTTTAGCCAAGGGTCCGTTCACTTTGGTACCCGCCTGTTTTTCCGTGAGAAAGGCCAGCAAAAGAAGCGCGTGTGAGAGGAAACAAATTGCTTGACACTGTACCAATAACCGCGGCTTGCTTCGGGTGTTAAAATAACGCGAGTCTGTGAGGGTGTCAGCTGTTGTGACGTGCCGTTCCTTACCTATCTATAGTGTCGAATCACCATCAGATTCTCCTTCTTGTTCGCTCCGGGGAAGTTGTCATGCCGCTGATCCGATGTTAACATTAAACAAACCCACGACCGGGCCCTTCTTCCAGCTAATCACTTTTTCTGTCGTAGTTTCGCCTGGCCCAATACCTGCGCTGCTCCACATAACTATTAACTAGGTCGGACATCTTAGAGACTTTACAATCGTGCATGCTCCCGCATGATGCGGGAATAAATGCAGCAATAGACCCGTCTCCTAAGATATCGCGCTCTGGCCGTAAGTGGGGTATTTTGGGCACCAAAGCATTAGTCACTCCTGTGGGAGCTGTTCACACCCCCCGTAAGGAACCCGGCAATTTAGTTTAGCGTCTAGCAATGAACAATTACACTTGCATTCTCTTTTTCTTTTACTGACAGGACATACCTCCACTGTCTTTACAGATTGGCATGCTTACCATATGATTGTTTTGAAGCATGCAGCGTAGCACATCTTGCGGCTCGGGCGCAGCTTAATTAGATTGTTAGAACCCCTGAAGGTCAACGCTTCACAAAATGAGGACCCTATTATTGCAATAATCACCCCACCTTTCCGAAGGAAGGAGCCAGATGATCCAGGTAACGGCTATTCGGATAAATTTCCAATGAGTGTCCGCAATGGGGTCGATTTAGTCAAGTCGCTTCGTGAGATTGGAGGCTCTTGCTATTGGACAATCGACTGTCGAAGGTTACGGTGTTCCAAAGCGTCTACTTTCACCCAAGCGAAGGGCACTCAAATCAGCATCTTGGAGGACTAGCCGTCGAATGGCCAGGGTACAAGGCTTACATGCTAACCAAGGCACTGAACCTCCCGCAGATAGGAAATGTCATGAGTCAACAGAGATCTCGGAGTGGCGTATTTGCTCGTGGTTGATCGGGCTTGTACCAAATGCCCATGGGTGTCGTATCTCGCGGCCTACCTTCATTTAATCGAAGGGAACTGCCTAAGGGAACGACGCCATACGGTATACGCGTTAGGGTATGGGGCTTGGTTGTGATGCCCCAGTCTTGCCGAACATATGGTACTTGTACGAATTCACGACTCGTTTGAAACATGGTCTCCGTTATGAAGTAATCGTTATCCATCATTTCGGTCCACTGCTATGATTGTACTTCGATCTACCATGTCTATGGTTTGTATACACCGACTACCGCATATATCCGGAATTATAGTCTTGGACAGTTTTGGCCGACGTGCACCTAAACACAAGAGGGTAACTACCAGCAAGCGTCGAAAGGGTTTTGGAGCCGTGACCGTTCCTCAAGAGCTAGAGAATTAAGCGCACCATGTTCCGGGGCCCACCCCACACAGAAGAGAGGTGAGCCTTCTATGACCGTTGCCATTTATTTTTCAGCCGAAGCCAATGATTTTAAATGAACGCATGCGAGCCCAAAACTTCCCACTCACGATAGTTGAGATCAAGGGAATCTCCTATCGCCTAGCAGACGTGATTATCTCGGCCAAGTTCCCGCGACATCCGTGTCCGTACCTAAATTTGAGGCTCGTTCACGCAAGACGCTATTATCTCGTCGACATGAGTGATCGCCGACGCCTGGGTCCGAATCAATGCGGTCGAGCTTATACTTCCGGACTTCATGCTTGTTTTAATTCGCTGTCGACGGAGAAGACAAGCGAGTCATCTTCTTTCTTTTTCCACGCGTACAAGCTTGGCTGAACTACTTACGGCTCAAACTGCGACGAGCTATGGATGTTAGCAATAGGTTACTTCATAATTTCCTGCTTTTGCAAGGTGAGCACATGAATCATCCACGGCTCGAAGCGACACTGAACATGTATGTTTTGGAATGCCTGATTGCCTGCGGCACACGAGCAGTCGCTGGATAATAGAAGTGTACACCCAGTTGGCGTGACATTTTTCAACGTTAAGCCTTACCGTAAACTATAGCCCAGTACAGCTACTAAGCTGGAACGGGCGCGCTGAATATGAAACCGCATTATTGGCGCTCGACCTGATGTGTTGCGCGGACATTGGCCTGTAATGCGGAACGGAAGTACAAAAACCGGTTTTGCTGGGACGTCATCTGATATCAGGGAATCTAACCTATTTATAAGTGTATCTAAGGAGCGTGATATCGTATAAGGACTGACTTAACCCCCTCTGCCCATATACCACTGTAACGGTTTTGGGAGGCATGATATTGATCCTAGGAACCAATATACAGGCAGCCGTGGCACCGTGGGAACGACCAACGACACCCATCTTTCATTGCATCTTACGGTCCGCAGCCGAACTGTATTTCGGCCAGAGTGAGTCTTCCGACCCTGAGAATACAAGCAAAATCGTTCGCGCACGCGCCATAAGCCAGTCCGACAGCTTCGTTTCTGATCAGCCATGTAAGTCCGTCCCGGGTTGGAGATGCGGACTGTCCATGAACACACCTGAAACGTAGACACCTTAGGGTGTATCGCGTCTGCAGCATAAGGCTTTAGAGGCCCCATGCCATATATGATTACGCTGAGGGGAACCGAACATTCGCCTTGGGCAGTTCATTGGCATCATGATAACTTCCCAAAAGTACTGTACCTCTCCCTGGAAAGGCGTTAAACCTATTATCCTGTATTGGACATGATGATAGAAGGGCTGGTTAGGTTAGCACCCTTGTCGGCATCTCGGAACGCACGCAGGGGGGGTATAGCGGCGAGGTTAACCACATTGTGATTCATCCGCGATAAGGTGGAGCAACACGACGTTATCGGAGAATTCGGGACTGCTGTAGTAACCTCGATATAGAAGGGACAACCGGAATCTTTAATGTACTCGGGCCCGTTTAACAAAAATGGTGAGGGCTGGCATCTCATGAGATATAAGCAAAAAGATCCCCATTACTAGACTTGTGGGTTGGTTACATCCTTGAGGAAGAGCCGTAAACAGCGACAAACCTAAGCGAATTAGCTGTTCGTAGCTCGGACCGGCAGTCCCTTCCCAACGATGAGAGAAGAACACGTGACCTGCATTTGATACCTCAGCTGGTTAGGGTTCATTTTCTGGCGTTAGGGGAATCGCGAGCCTAATTGTGTGATACACATGTGCCATAGGTACTGGCCTAGTGCGACGTTTCTGTCCTGTGGTCATCCCGACGACCCTCACCCTACACCTGGGGTTCGTCGCAAAGAGACGTCAAGTCTATAACAAGAGGAGTTAAAACGCGCAGATGAGGCACGGCGATCGGCTATTCGGTGTTCGACTATTGCCATAAATTTCCCCTCTACAAGATTCTTGTTTCTCATAGGAGTGTACTGAACCGTTAGATCGGCGTCTTGTTTAAAACATGGTATTCTGACATGGGAGAAAGAATAATCAAGCTACTTATTCCCACTAGCAAAATTGTGTCTTATCTTCTACAATCTATCTCTGAAGCTCGGTGGGGGGTTTCAAATTCTAGGCGGGGTCGCAATTGAGGTGGTCTAGTGATAACTTTACAACGGCCGAGGACAAGACGCGCCCGTAGCATCTGTTCGTGTTCAAGATCCAAGTGCACGCTGTCTGGTTGTATTTGGATACCCTGCCGGGCTGGAGCGGTCATGACAACCATGTCAAAGCGACAGAGCGAAAGAGAACCTCTGTGATCTCAGCGACGTTGCAGAAAGTCATGAAAATCCGCGGGTCGATACTGGAAGCCGCTCGAAATTGATCGATTCATCTCCTAGGTCACGGTGAAGTGCCAGATGCGCCGTAGTATGCACTATTTGGCGAGCCCCGATGTTCTGCACGGCCTCATAGTACAGGTTGAGTGACCGCTTTTTCCACAAAGCATTTTCGGAGAAGATTTCGATACTCCGGAGAAACACAACCGAAAGTGGCTAGCCTCGTTGATCGTCTATAGATCCGGGTACACACGTTAGCCTGACCCATGCCACTAGTGGATTCCATCTCCTTTATGCCTAGCGCACTACGCGTCAGTACGCCGGTGATGGAGGAACCCGTAAATGGGTCCCTTTAAACTACGATAAAACTTCCCAGTCACTAGATCGCCTTCTCATCGAGCGCAGGTGTCGTATCGCTGTTGTTAAGTTCTCGTGAAGATCATGCTTTGGGGCGGATACTCAATAATTCTCTATCAGTAGTATAAGGAGGTTTCCTAGAAAGCTCGGCCATGCTGTGCAGATTCGGCGCATGATTCCTCGACGCTCTGGGTGAGACTCGGCTTACCCGCGATTTCGTGATCAGGATGGGATAGACGGATATAAATAAGAAGAGTCACGGACCGGGTCAGCATCTTGTCAGAAGCGGCCATTCTAGTTTATGATCGTTTTTTCTAGTATTTTGGTATGACTCGGTAGTCAGTATTGAGTTAGTGGCAGGAAGGTGCTTTCCCAGAGTTACGGTCACCGTTTCACTAAGGGGAACTGAAACTGGGATTGCAATGCGTCAAGATGAGTGGAGACTTCGATAGACGCGTACATGCACAGATGCTACTGTACTTACACGGAGTGAGGTTCAGTCGACTCATCCCGACATCACCCAGGCTCAGGTGCTCAGACCTCAGCACTGATGGCCTCACCGGTCAGCATCACGTCCCGTTGCTTATATACGGCAGCGGTGTGCCTGCTCGGTGTCGATGACGAGGCATCTTTGCGAATTTGCAGAACCCATTTACTCCTCAGGGCTGGTAGCTTGCGTCTCCATTGCGCGGCGACAAACGGATTGTTCGGTTGCGGCGGTAGTATCAGTTTCGAGGCATTGTTAGATATTAAAGTTGGTACTAGAAATTGCCCACGAGGACTTACCTTTAAAAGGTTGGCCTCGTCTAAGTCACCCCCTAGCATAGCCTTAAGGGCACAGCCTCCCGAGCTGGCAACTAGGCTGGTACCAGGTATCTGGATAGAGGACGCTTTTCTCGGTACTCCTTGAGCTAACCTTTTACCGGGGGCGGCTTTTCCTGGTTCTAATGCGTATTTCGTTTTGTAGAAGTCTCTCTCGGACGGAGTAGTGACACGAGCAAGCGGTTCCCGAGTCGCCCTACGATAGTCGAAGCATCCCCGACATGAGTCATTACTGCAGGTCACCCACCGGGTTTCCTCCTCTCTTTATCCATTGGCAAACGTACTTTTCGTGGGCCATTACCACCATCTGAAAAATACCCTCCTCAGCGCTGCCCCACTCCCACACTCTTCACGCGCTCTCCGATCCGGTGGTCAGTCCGATCGAGCCGAGCATCCAGGACTCGGTGAGAAGCTTAGTCTGGGGATCTGGCTCTCATAACATATCGGAGCGCGCCGACTATCAAAATTCACAATGGAAACGAGAACTTCACGACTGATCTTAGCTTATTTTTCCAAATTCGGGCTTTGACTTGTCACTCTTTCCTGAATGAAGTAGGTGACCGTCTGCTAATCTTATCGGCCCAGGCTGCTTCCTCTCTGGCCCAGCTCCGACAGACGCTGGCTCAGTAGTCGAACCCGTACAGTCATGACTAAAAGCGGCACGCGAACATGCTGCTGCAATGGTGATGGCGGTGAGTGGTACAGACCCTGACTGTGTTCGCCAGCCCCCGGGCCTAGGGATTATCTAAGGTACAGTTACCGCAGTTTAGTGTTAAAGCGAAACAGCATGCGGGCGCGTAGTGCTAGAGAGCCTTCACAAGGTGTAGCAAGAACAGCCGCAGTATTGTCGGAGTTCGAAGAAGCATGCGAGCGCTGGCACATATGCGTTAGCCCCTGTACGTAGACACGCAGATGGATGATCGGTTCATCCGAGTGTACCGCGTTAGTAATTCCAAGTGCGCTTCGGACGCTGCGACCCGTGGCGAACGATGTCTCGACCGGTTCTTACACTAGCCCGCTTGCGGACCCGAGCTCGTCATGCAGATACATCACGGTCGATCTCCCATTTGCGCTAGACTCATTCAAGTTGCACAAAAGGTGTTACCGTAAGTCTCGCTCGCCGGTACGGTTTGGTCCCTGTTTCCAAGACTGGGACCCGACCTCAGCATAGCCAAGGGTAGAAAGGTGCGATGATAGGGCCCGTTATCCATTCTACGGTACACGTACCTGTCGAGATAGCGAGCAGTCTGAAGCGAGGCTCCCTTTTCCGGACAACGCTAGCCGATCGATCTTAGTGAAGAAAAGCATAGGGGGAGTGCGGCAGTTGCTCGTATATTGTTAGTACGTGTCCCTCGATTACCTGTGTTACCAAAGACACGCCTATTGTAGTCCTACGAAGCGATTGTAAGCACTCTAGTACGCCTCAAGCTTAATTGAGCAGACCGTGCTTGGCTAGTGGTGTCTAGTCTCGGAGAGTGCCTTATTAATATTGGATACTTTGAAACAGCGTCCCGTTCCGTTACACAAGAGTACCGTATAGCGGTCGGGTCCTAGTGGTTATCAGGCGACTCCCAAATGGTGCCATCGTTTTGCGCGTGTGTCGTCAGACTCACTCACCAAATGTTGGGATTATGTAGTCAGTTTGTTGCGCTTAGGGGCAAGACGGCAAGGTAGGTTGCCGGCCCCCCAGGGGAGTTTGACGAGCCTCCGTTTCTATTTTTTCACATGACCTTGACCACTACGAGAAGATTGACGTTCCCCACGAGCAACAAGTATAAAAATAACGCTCGATCTTGACCATCGTTCTATTCGTCTTATACATGTATTGGGGCAACGCTTTAACCGGTAATAAAGACTGAACTACCAACTAATACCGGGAGCTCAGCGCCGTCAGAGCGAAAGAGTTAAGCCGCTGTTCGCCTCCAACTTCGGCTATTGGGACTAAGCAAGGGCGATAGAGCTTAGTGCCATGCGATACGAATATTGCATCTGAGAAAGCTTTTTATATACACAAGGCCCGTGAACTGTTTGAGGATACAGATGGTTGCCATACTGGGCTTTTCCAAACTACAGTCTAGGCTGATGACGGTACCAGGTCGCCCCCTCGGTAGGCGCAGTTAAACTGGTAATATGGTAGTCTGTAGCGTAGGCATTAAATCGGATTACATAACCGAGCTTGTGCGAGAAAACTGCGCTAGATCGTTAGTGCAAAACTCGAAAGGATCATTAGCACTAGGCTAACGGTATATCCTGCTGTGGCGTAACTACGGGGATATCATCTCCACGCGTAGTGTTGGACAGCAATGTTGGAGGCCGGGCCATATTCGGGTGTCCGAATTCAACCAGTGTTTTTCGTGATCCACGAGCGTGACAGTGACTCGACTTACAGTCATTTTCTCATTTGCCATGGCAGCGTCATCTGTGTGGTATCGCTCCGTATTCTCCTCAGCTGACGCTGTGGTCTGGATTGGCGCGCCATCTCTTGAGGTCGTCAATTCCATCTTTATATAATGAGTTTAGAGCGGACAATCGGCGCGGAATACGTTACTTTATAGGTGCCCTAATCCGCCACTAACAGTAAGATCGATCCTAACTTCTGGTTACTGCTCGGTAGAAGTATGCCAACTACTAAGGGCAGACCGCATCGTGTATATCACGAGATTAGTAGACCGGGTAGTAACGCTTGAGCAGTCTGTAACGACTTCACATAGGATCGAAGATACCGCTGGCATCGCATCATTGGTAGGACTGTGTCCAGTTGATGCCTGCAGATGGGCATATTACTGACGGACAATATTTTTGGATGCTTAGAGGGGGTGAAGCCGCTAGTAATTGAGAGGTGTAACCCAGACGCAAATACTAGTTGCCTTATATCTACTAAGTATACGTGGTTCAACGTCATTTCAACCACATAGCGCACCCGGGATTAATCACGACGATACCGTATCACATAGCTCATGTCCGTGTGTTCGCCGGTTACAAGCGCCGACGTGGCTTTACGGTCGGATAGAGCCGCTGAGTTGCACCGTAAGGACGGGAACGATGTTCACGCGAGGAGCAGATCCGTCGCTGACTTAAAGCTTCGTTGAGTTGCTTGTATGAACCGCGACCGACGCACGATCCACACCGGCCAACGTGTGCCCACGGAGGGTGCTAATTCGAGTCGCGAAGCTCGTAACTTACGGTCGCGGTATACATCATACCATTTCACAGCTGTATGCCCATTATCGTTCGGATCCATCCGTATTTCTGACCCTAATTTTACTTATGTGCCCATATATATGTGTTACTCGGAATACTCGTCACGAAAAAGAATAACCACTTCAAAGTCCCAGGCGTAGTGCGAGCGCGACGCACGGGGGACGGCCCACGAAGGCCGATAAGCCATTACTGTACACCGTTAAGAGCTCTCTCGAAGTAGACGCCTTCGGGATCCGTGGTAAGCACGAAGGTACCACTGAATCGTCGAGGCTGCTACTTGGCAACTGGGACTGCCACCTCCTTATCCTTTAGGGCAGGCTGTCTGGCCGCATTTCTTCCTCAGTGGTGGACCGTCTTGTATAAACGTGCGGAGACGAACGTGGCCGCTCCTGGCTTTGCAGCCGGATTCTTCCCACGGGTAGTAGTGTACATTAACCCCGGGTTCGAAGTTAAGCCGTAAAAGTAATACAGAGTCGCGGTCAATCGAATGGCGCTTATCTCAAAATCGTCCTTCCAGCCGTTCTGGCATGACATTAATATGCACTTCATTAGAGAAACGGGGTGCTACTCAACGCACAACATGTATGCTGGCCACGAGGGCTCGTGGAATGGGTAAACGAAGGATCACTAACTACGTTCGTTAAAAGACGGGCGTAGGGTCTTGTCCCAGCGTAAGCAGTGTGGAAAATGGAGATACTGCGACTATCTGAGGTGAAACTGTACATCTCGGTTGGGTAATATCTTAAAAGTGGCTTTGTTTGGCACCTTACCTATAAATACTAGCAAATATTGAAATGATTTCCGTAATCATCCTATGCGCAAATGAACTACGACTTGGTCAGAGCTGTGATTAACGACGACCTTAGACGACAGGCACGACTGACGGAGGTCTACAAGCGTAGTCAGACAAGGCAGGACAACGCTTCTTCGGTCTATCTACTAGTCTGCTAGGGAGTAACCACGTGTCGTCTCTTCGCTCTCCTGCAATATCCTCTTCGTTTTCTTTATAAGGAACGTAATACTTTTCACTCGAATTTAGTGCTAATGGAGATGCACGTTGGGATTGGTAAGCCGGAGGAAGGCTTTCGTCTCACCGAAAAGTGACTCGAAGAAAAGTTATCCCACATAGCAAACCTGTACTGCGTTGTGGGTGCGAAAACTCTAAGCGAGAGTCGTTCGGGGGAGGAATTGATAAGAACGCATAGAATTGCCCACTTACAGTTTTATTAGTACTGTGCGGCAGTTCCAGGGTTCTTGGTGATCAGAGCATCCTCAAATATTCAACGCGGTCTTACTCTCATGATCCGCCGAACATAATAACACTGACACCACACTACTCGGCTCGTTCGCTTGGAATATAGGGAGCCTGGCGGGAATTAAGCACATCCGGTGGTTCCGGGGCCCCGTCTAACCGCGATCCTGGGCACCCATCTTACTTGCCAAGTTCCGCGTGATGTGATCTAAATTAAACAACCACGACGCTCGTCCTCTTCCGGGATTGTTCGAAGGGGTTTAGCCGGCTCCATGACACGCCTGATCTATCGGGCTATGGCCGGACATGCACAACGAGTGGGCGATAGGTGTTACGTGGTTCAATCGAAACATCCACAAGTCAGGCCTACATTCGTGGAGAGTAAAGGTGAAACATGCACGCCCAGTGGGCCTCGTTATCTGGGCCTCGTCGATCGAAGTCGGCACATTTCCCGGGCCAACCGGGATGAGCCCATAATAATCCCACCTGCGATGGCAAATAGACGTTCGGTGGTATGTCCGAACCGGTAAGCTCCAATCCCACACTCGAGAACCCCGAAAGCCTTTGGTAACTCAGTCCCCGTGGCACTGCGTACCTAACCTGAAGGTTCGCGGACTGGGGGCGTTACACTCATGCCTGTTGTTTAATCGTTTAAGCACCTTCTGTGGCCAAGCTCCACTGGTAGGTGAATATAACTGGATAAGAACGCTACGGATTTGTCCCCTTGCCCCCCCACGGTGTCTGGACAATTATATTTCGCTAGTTGGAGTGGGTTCAGGAATGTTCGATCCTGAGCAAGACTTGATATCTACGCTCTGACTCATCTCACAACGCACTACTCGTGGCCGTGTAGATGGCGCTCACAAGAACGGCTCGCGGGAAACTTCCAAATGTATTATACGCAATATACTTATTGGATCATAAGCGGTAGCCTGGGACTCCTACGATATCGGAACGCCGTCAACAAAGGTCACTGCACATTTGTAGCTACATGAAGCAAAATTCAGCGCTTCAGACGACATATAAAGAGAACTACGAGTGATGGCCTCTACATCGCCCCTGCTGTCCGTCTAATAAGCCGTTTTGGACAACGGGTTAGAATTTTAAAGATGTGGCGTGCTTGCATAGTGGGTAGTTACTGTGTGTGGAGTTTGCCCCCCACTGTATCGGGGTTCATGATTGGCGCACCTACAATCGGACCACTGTGGGTTCCGTGGGACAAATCCTGCCCCCCATTTTTTCCAATCAAGCCTGTGTCGCCATTCCTGAGAGGTCTAAGGTATCTCTTAGCAAGAGATAAGGTGACATTAATAGGATTACGACGGCCGTGTCAGTACACAAAATGGTTCTCAATTCACGACCCTACCAACCACGGCGTTAAGCTAGGCCTATAGGCCAGGAAGGCCGAGATCTTATATTAAGGCGCGTGCTCACGTACCCCGCACATAGTCCGAAGTTGGCGAGTCTCTACGGGGCGTTGTCCTCTGCTTCTCCCACGGGACGCAGATGGGGGTATAGTAGGTTGCTTGTAAGTGAAATTCGGGTGTCATGTTTTTCTCAGTCCGGCGACCTTGACGTACTTATGCTCAAG"
    val examTarget = "CTTATGCTCAAG"
    val examMismatches = 4

    val breakGenome = "AACAAGCTGATAAACATTTAAAGAG"
    val breakTarget = "AAAAA"
    val breakMismatches = 2

    val step6Genome = "GTAGGCGAAGAAAGTGCTCGAAAAGCGGAAGTGCCCTGTAGACGAAAAAGGCGGCGCCAGGCGCAGGCGCGGTTTATTGCCGCGTCGAAAACGCACCCGCCAAGTGGTGGCTCGCAAAGGCTTCGACTAGAACATTGCTCTTGGCCGTGTCCCGCGCACTGGAGGGTCGCCGCTTCATCCTGGCAAGTAACAACTACCGCCGAAGCCACCACTCGAGCACACGCACTGTTTTACCTACGAAATTTTGCTAGTTTTTACGGCTATATGCCCCCTCACGTCAACCTAGGGTCCGGATCTAGACGCAACTCCCATTCGTAGGCCCGCAATGCATTCTTTCAACAGATTGCCCAGGTTATTTG"
    val step6Target = "TATTGCC"
    val step6Mismatches = 2
    // answer was 9

    val g = step6Genome
    val t = step6Target
    val m = step6Mismatches

    val matchList = matchPatternWithErrorRate(g, t, m)
    println("quantity = ${matchList.size}")  // step 5
    for (i in matchList) {
        print("$i ")
    }
}

fun matchPatternWithErrorRate(genome: String, target: String, mismatches: Int): List<Int> {
    val matchList : MutableList<Int> = arrayListOf()

    for (i in 0..genome.length-target.length) {
        if (i > target.length + genome.length) {
            break
        }
        if (hammingDistance(genome.substring(i, i + target.length), target) <= mismatches) {
            matchList.add(i)
        }
    }
    return matchList
}