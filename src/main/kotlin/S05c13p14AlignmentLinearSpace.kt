@file:Suppress("SameParameterValue", "UnnecessaryVariable", "UNUSED_VARIABLE", "ReplaceManualRangeWithIndicesCalls")

import util.AlignmentLinearSpace

/**
 * Code Challenge: Solve the Middle Edge in Linear Space Problem (for protein strings).

Input: Two amino acid strings.
Output: A middle edge in the alignment graph in the form "(i, j) (k, l)",
where (i, j) connects to (k, l).

 * See also:
 * stepik: @link:
 * https://stepik.org/lesson/240308/step/12?unit=212654  MiddleEdge problem
 * https://stepik.org/lesson/240308/step/14?unit=212654  LinearSpaceAlignment
 * rosalind: @link:
 * http://rosalind.info/problems/ba5k/  MiddleEdge
 * http://rosalind.info/problems/ba5l/  LinearSpaceAlignment
 * book (5.13): @link: https://www.bioinformaticsalgorithms.org/bioinformatics-chapter-5
 * youtube: @link: https://www.youtube.com/watch?v=3TfDm8GpWRU  Space-Efficient Sequence Alignment
 */


fun main() {
    // NOTE: these strings MUST BE REVERSED from those given.   The problems are described inconsistently.
    val sample = """
PGRRWMNKSLVNCMTEDYLDTKALVYPHECLFPILMNSSGPSAMQYHHNDPASYDGCANKTSMRVMIVAYIFFEMLWMDGQTWTIDKAPRPLFFNLKLETCQGYHHLASGGPGKNYKRFSMLAYQYIKEEQMEMMPYWHDREWNMQGQWHFAFWFANAHLPKNMCWKELCLTSMKWTFNRCWQMLCLHLSSRMGEVHWAMEVVGYEGGKGDHDLAKTIIKHRGIDKCADFLCASHFITAMCNMRAHDQHVMYFWSWDQHAKISHPVIYMRFIHFHMGCRERLFIGEATAYVESVHPEFCRNDHLSGISCHECFIAAGISGTQTNPMVYIPCEPFGCCCAFTTGGGQLFTQCSFNSIFDCYMAYNGQKIPFDATCMCHNFPHASKIMWVGRFGLGDAIFQIKIAKYPQSVYKCTAIDYGDVLHGMGWRFYITWICHKNPLRDIKNLTRFCHQDCYEKQVIRADEVIVLMNFYNMRESAQLVGNNRWYWRGGIANKWCADSDLWQHDWYMKTVMNCAKVDWFSEAMCGFHCESHCIKAAVANRMSTAIGGFTAFLFKCTQICDLNGMWRDFLGPPNVFHACDGMQHMRLPHNQYCNGDRHDHGGHCKNPLGICLMLRVQDRQHINEQSIGVEAPPQTFVQIHICGNSHMPCDNPPGHSYFYGPMAYECLGLFPDLHLFLGSPYSHYAHGFYYKKWEPRQQTVAGMAECTNAKQVTNQDCHFLWVRQGMQAEGEFNLGHMFGMGVDEVLTGIFFWSTYAPYTVERKRMYKGCGKEVNHQQKIDCQYPKGCPLLQMKVGHNLWTCGIWVIFACVSMMGWFNDITMIANGPFKPRMTMVGIFCHGQCMWNCEPEIGHIFHWNQGLIRHVLWQDACASHEWRQIALCYKDGNIESTTGRMSQLRSNEDVTIMNWKNLPWFAPDGMVEKWPGPTGKLICHSVPWGNMWTCMFWDRFNQSWMEVKDLKGMFSYSVMATLHKFQTWARIRNCALMASRPSDMNPIGYGGTCWCSANDRVMLVKKQYWNNTTCNCTCPRMVHCNDGHFAILGKVQQNIARQVDLMVPYGTPCFWRYMITWKLPYDWECRCWEPSCVSTSRYRKCGQMEDRCHHMVWKSYHSDGNDEGFKQIPPQGHTQRSEKVPTVGTNYSPWILGSLAPHCWATMDILNPDNEADDLPLNEGSWCKDTDNAGIPNPHCWAVRDNQCLLHADPYKTLHGGLAAWCMEGQYFVNWLLHFTCKNNQNDKMKTERTQDFFKCTEELITRHQIAWTTFLAFWADLVFYKQVCKMTMAVFESNKSYFLAGVKFQNNSIKSRQPTIPQNPTEGDEIPNLLILFDDLCTSDNARVTNQNIDCVRMCGGTYNIEIPVSWDRKIGFTDGGIRWMVCSNLFRIQVPMCHCIEYWPSCWNIYQDCVKHNGKFNMYSPLCEMSTDVRHHITLQYALHCFCEPGAQAPPHMKQSKDRKYPREYGMIESKTDYITAWYISMWRMHVVEFVNENLPCVKKARKECAHFPDTETGYCWGHGNYDAFVNQTPWYGQITHQASPYQFMFLAAKLAVLPIDTPYVIPKIMDKPTKMCDQLFYRSGRVPDCEFFYNQCKVVFKLNYLCIEMSVEKTGVTAAYGESSYKIQNNTSCWDRDGRKAWPMPRSLCAERADVSSADPADTSMFQCVLQVAMQSCNMMRSSFKPTATCRMWQDYFDQMFASPYYVGFIGIKIKYQFGLPPTALYGRLCPQAAIYSMYAQNTLKMIPLMMVTKCTHPPTKWETMWMIKQLPDAAMMYHGCHEWWRQNQIITSHWEFDNHHYCDQEYSMLKKISHYHPIACADPLNQIGWQTYNNADAMGTGQQRQSFAQKKLIDQLWNRWVTSHTQINKGGQVNHSDLEGIHKSHQVQREMMWMNDWCSDGCDAIGFRAEGQPWYGAFLDSAFKCYVSMCWGPPGTKWECYDSLYYDWDTYPGDGQMDCWQHDCIGICRNRAQVALYYKRSKNMPYKFTEDWCMKIWETCERTLSGSSLNLFVCGDARYCPMFSDQDENTIYCSTPKCQLGFPIWYQRTIEMYWQVDVFHDIWNWTYYEDNTMCFWQIWCCNRIGGHHRTGNLYVMNVILETRERIAFLFETWEPDAPTCTARYLAFDHKAEWCYNYITSFVMIFAMDPNFQFPHHKCPWEHDRKLTGNDSYWDPDPSTEENHKELISRLCTGHYRMNMSWSETWNLDFKWGDHGRELHANGREMSRMMELMMDEDWMGREVRCEKWIVLAMVYHIKAKEQYGGCKIIFTWSTPQRWHHQGRWEFCRYLRIFAFDWADWGFGLANDNQNGTNCKLGAWPQVNYRYDKNHSLECSRDFECKDEKFTYTPDGKTSNCVESPCRTWRTWVTARTWYEWSQLQGRARWSDEDIWMKVTAPSTLPTISYKPGYCMNLYVNMERSGFVNWCAEYPSPFMAIADPANWGRTQVCPDLMYSDYPCQDDWWHTWTVWALMDSWMNTYTAQVFTVLWAHMPWCRPDGCCPHPYMHDHQIEALDFEYYVWDVFKPMTYVYWACDKFPERSNEDNQYYTDGNQHLPKEQPHGFRKHITDGWHMHECNEYCYAVFAIHKRDNKYVQVVRCRINSPQIQSAFNLLGPPHSNTKVLELIGEDTPAWQWWSPLEDGGDWDVIRFNPSYKTGGKAVEECDEKASEIEFIFGPTSPIYNRQMMICPIKACHYWKWHVMYRMFQAHSCVVSTTVRWGSWYNLSPEPTTADPVHSSIINCAPDTEWVDPMWFRIIWLAIIKTWRGHAKAHFWNTFTTCAMHCEWDVGDPMPMSCHSNVNFIHKTIRYWRRRHKRTINYTNKKNCCWGPNRWWWLNSITKKRLDQFIECASRGGIGTHQRRCRWTIFISWCQEHHCGFPMSTMATYKPNCRAAKKWTEMLPKNAFWLCWCVQLCPPRANVAKQLTDHMTHYRKIGVQSIRDGVCAKMEIDWQWKIGHNCGWGATKSGSAFGSVLFNSTSVPKTEYVADHCCHNRQGPVHEAWKHNFAMLKKDNAAQLAIMRSGRKNPRRHDHTCYCYPTDPFACWNQHSNVDKFLMNGRSTHGYDKAKWDAEFNIDCDWYMTKIEQSWTHSHPATSWKGHVCPTGTFHKCQLYMIPGDGGMTANMDVKPGWWPPPCAAVKNFQKWTDNQHLNLTFVKAWHQGSKLEIFCKARTPRMDFNKHEFTMGGEERHMEWAEWNAKMFWWYIVSLFHCKFHVVLWHDRHPNFQSRMVVFDGWQHLKKIEVIAVSYYEFNFQNRDSEWVGCDFDRDFCAWIWSEGEREIIHNFGPASYRLSEHRQINGKLHSNYDFNKGVGQDLSYLAEDWMQDRVNQDQFMSFSKYNWPCYNKTSPSRMILVEPNMWNQRTERKSMTRLIYHDMQRWKPSSMVIKHRTSYRNVHWMEVQWAQLPIWQGMSTDPLFQWAEKAWDVNLKMEIRACDDGCYNPRWFIEMNIIPRTAWNRYMVVAESAWKLWFEPADHCRRHFWVVRKYKMIREVVAMMFRPIHRTWCADAAIGLPKMWPKQPILVNWMGMDEELEKCSLMVYCYPWVAHNNHAMVYCDLLMIDPVLMMDITYMTDNFWTYVDGKTMFCVVCHHVVKSGHSTKVFFSDVGHKITQPKDDVPFTLGKMQIMPDWAHRITTFRTLINSNSLAVIWWSRYVCHKRTGTRIGFCLHQIGGPPKGGAGMSPKENHIEMCAEEEYMCRLFLYCLNYGRCKRVWFDCIEQVPRMSQNQNGTVAEHRLIMFQTEWNYDDDGNAWKVYNKRMTHEEHKTAQSSQDLCAQYLPFLSMACYNGIRTAQELKRVNYNLFKALKHMINTEMGKFHEWMDQFWYFKIRWSSMWVCQVGTMPKLYISAAKMKTTPWVERNNNSGNIQLKGKQFACCGWYQDNPETTRRQKIDAESNFCERAADKHFDPPKKESLYKNWSVIHIWNGFLRRYKQQYQGRAKTKWFQNCSANVVWINLGVDHSV
YQLPGKCIENWISKMLFKNMHWFNSDMLVAKVSDRDRWEWGNEDHTDLHPHYWWTKIIFTAVNRNSFIYCYIWEQFCSSYVYHDWGSGYLYEINIGMAVTRYGTTPSEFVNLFVMAKSCWDVDLMALCTCCRQWVFPLDDFFNWYVENRKSKCNCRMHMFPAPNLTMSRCTSMRMPYWHLYFWDDWQQINVLKWAMEQEFLRHCHIDRAIHSPCGGPYFCLWYGKYNHPVAAKKAVGKDFTDCTQYDEGSNGPMVVYGCPCRITDCPEPAPVHCEIAGAGCPHPKDWDMHYLNFHIDWCWWPSWDTGENQYHKKAMSLDHKWIGCSYGSIMCWHIIFAIRDLEGPYTLSHITAWEWMVDTSQYAEKVKASFYNNWAQPPSHLFSIITRYSRHMYFGGEFINSMYFNMAFFCPGATFNPMYIVRAAIHWAAKWNGPRGRFIMQQSQWSCPAIALFWYPQRKGLDMKNGMQCHGIPNPQLSVEVFADCNINCCLPDEYYLFWYNLGRMFGDVMLITFDEDDEEENVYNIMNFAGCDEDLCQSKFWPGCKLPGHLDIEKKARVMNYNMQNVMYDAFCEYIPICGTYHQCCQSMIWNVQLRVLQDADINHMANMNCEENAYCGAGWFTCGIDTTRQIEGRENDAYPVFRFYDYKRTAWNNSPLKLQPNGAAWSADHFPKFFNKQNCHAFIVGLWESSKYVQHFEECYPDKRFMGVFPLHRMISRQHEHSSCDWAPRRHVYQLCSPNDCQRESVTWVHSKCSIAHWHKFYMYQDQRGCNYQMHCWGHSQPNVMLDFHIDLYEHKGKKKKWYEPIQSDKKEQSAICQLCGPELCGKQNKEKVVFKENGVMFDEKSMGAITVIHQKLADYNPWLKHIPQEENAWRIAVPGWTFATMRPVGLFERRCKRYNHDMRWVKANMEKMQYARKEVECPISMNLRVPEWSFEVPFSKSVFGRWQVPDTFSTSLYISHRPKQTVHQWDPVTGCCDIWWAETVRRELTGKKRLMCAMHIWSRRTYTHPKSFYAAFIFEVLQWGANEQTLLMYPIQCCCHEKWMQGNYWPMVHECRKDLITDVRTHKQWKPWTPGENAFYNRIQPDRFPPLCDVVQFYRHHEFKRRVHVHDHPQIFCEPARGEMDFGNAVYNRAKYPQFPHQRRMTDLSDYRYCIISGICIHPCYMTEKRRYTYYCEWVQNSSETKVHRWGRRQAPADNRIAWFMGMQDPAWQCFRAKDETRSLCKCRCECQQVPRCVMCYMKSQMFQLLKMCIYWRIMKRVMVWTRPWDDCQGKMNKQYMTHSWVGMMIRAIKKMKAEQMWINEVVANRLNSVTEIRWLTENTCTTGNQSPHQKGMAKDVHAPQDWCHHFTACIDWEGGDQTLVSFTQVIGNMFGQYEVTVECEFTHYIYWEYQEFQPIWDIGSHLWGRDFPIHMRAMRQCIKMAIGEHGTHKEGECSFKALKHLRWDCIRAFPMKMCLGWYLQNANVRKLQRTSHNWFRPEPWGQPGDAPNFWQYAELWMDMHKHCPGCMTLYWHADVVSVERVVHRYAWVYMFLLGLFSYWRHTHMHTDLMIDFCTYVAWEKDQDHNDEWIPCKYSWLPGVQANNNAKLCCDDNQEMSQPPQQYWGFIVAWEQVSFIQDRASHKSNHMHTHGKTRRNFSCFICHFTSKAKNLNMWKDSICSLCIVYHPRIERFLFIDWWRGVQEWTAWFYVPPQVSQWYGIVGQQQRWRGPCNYWNQNDQQIGSFSEKYTGPTTNKSYYDQHINHGYAMKPWVREIEWMASLKGTHCTIQASEPDMVMRCDMVIIDSYSGHNAMLKKASHYHPIAIADPVGWQTYNNEDAMGTGQQRQSFAQKPTYRHYYWDQLWNRYVTSHTQDNHSDLEGIHKSHQVQREMMWMNDWCSDGCRIDAIQDVFFDNICAEGQEWMGEFLELDADNYSAFFMRCCWDPPGTKQDTLDRNQPWECYDSLYYDWDTYPIDGCKTFWVQAWTQVCIGICRNRAQVALYYKRSKNMPYKFTVQNLETCERTLSGSSLNLFVCGDAVICNAERFCPMFSDQMENTIYCSTIKCQLMQYGSGQIRTIEMYWQVAVDVDYEDNTMCFWQIWCCNWHHRVANLYVMGTGKREREALWEPTWPTCTARYNANDHKAEWCYNYITSFMQAHKIQSFHGEHDRKLEMERDSFRHLCNYNGHLSQWADLCFTFCNIKRTTYWAYWYCDKYCFHWCHLCWIGQGRRTALEKDWTGSCEPTQIFADRVMIATHSPGPQRTCFEVLAQFSIWKMQRDQIGMADCEDADMQGCSKESWKLCFCWLFFLVEAFPEHTKRRCEKQSYFMYPCWSELRFQKTYYMHVCEIITRTTHHSFHQWWRGCMHPWECHQESRMETMHEDKRYKDWKNCATRKSTHCDHCYPTVSGCEHWCQSNLMWFYMAMSQTYQTVNQTWVLVDDSKYHNPCRAHDFINDYTCWKERTRMTRQIQRLCFGCIYYNVFTSYLPHPGTKTMKQKPQIYYWLRVSCSPAQPFTMGFYHNSFDLMDCAVGMCNLPTRPWNRPPPEQHAEWETERCYKINRMHCPRQPEVQMHWQYKMGHGVFNYDKREDGDTPLLWHSRNFGNFNKMPLMLNKGKLKAEVQIESHSEEVSQNKNEKWGGTHLETVFRQCNSKHAPIQFWKRSCWVKMEACSCKKITTPNDQWYEGCHIWNLFRNVNHCYQAPIYHPVFKYMPYLMGKHHAKNVGGFANYMAGMPFGAAWVFYDCYQWVPYWEDWDVYNGYNNKNFHTQRRKVHKSWHGYFMFWDKNGQLMKLRSRWRSIHKHLWFAEIICMSMVAVYPQRESPKSLSFCIPEYREMYTTAEPLIPAPQPMMFVTLHPQYHFNDTIWIFAVIANTLQVKACYPTGMPKYRETIINKPGAWKYCGSRFWRRRGQQWSKWQFNILFMRDWVKQANFLWSIRCYHLRTFLAFNWCLAMQQAEQPGFCLILWTTIKIWSRENKGSRLECILAREEMQKGHWAHGMSCYRMRDWNQNDFNWRVKAPCSTKTWRYQYSYFACRQKQPCWCKLLLRTSTNAFSIKKPIHTHPVDSLVFHSRNLRQLCMFCQFHQKIIQHTHCRKTKYYSWQYMMELRNLFYSGKAIRRLYRVDMRYLPTDGEYKSADWQQFIACWGTVYTLYDQIEMMRHEGFFPNPSVNIWQGHKYWKNDDAHGECPRNPGGRMYERTHMRPSNGHGQVWKTVKFWHFSYCWDAKWKHQHHSQTRNHSFDCIQRDHLCIQENGSTKNITPPEDFHSVIWQEFARWFPEDRLVKDSEGYTLTNKIYMKEVAVNQKFRWCALVINFLYPYQVIHSHGAQLEFPRASFVSPKTPKRPDQVWIRCQEKVWQPGWVCNFPEPNIWDWWIYMIREIMTFGAKHWSCHFIAAMADGLHWWAGTASDLCHDEHAVWPLIVYKSASEIANFNHLNARARNTWDVPHVVPWSHQPPVAAHSKLFMPMWKTCDFVGGCCEEWVKLCPSHYTYDCWDLYFKKPQWTRHEEKNWMAEYCKFTCCMRYVLPMVVFCYWWYRCYVEDCNNMWHMFAKKDYCMSSPLLCITDPRPPPHEIQVDSAYWYDGQLEMGNRACMAPGFAKKPCDIHFQNYNECGRLNLIRMIEYRRASWKPYSCNSPSKRSNNLQYPHKMTASKTMFRGEPTFNTRNLPGQKNITEWRYEQINFSTLVCHYFQSSNGRKYREECTKWGVWHFNNKNQKECSAHVTHYSAKKRSPINFHERIQPPCNGNPMKKSAGWEEDEWVQQCFHCSLPANLFFWPNDNECVPDRTGCHPPNLCQHEKIMAKGAPWDMFWNVCDFFLPYYCWAAAPDLYFIMNFGIIEVGMFDLHIGSNEVTMEKQKVNSQTYPRLAPVWRFTHNGYVEMPTRMFYVTSGPQHNRPVVHERRSHERRCCYMIINSKVIRECPDRAHRIDSVFEHMSERWFEWRDTQARMQQIDYKLKYMHIKEEI
          """.trimIndent()

    val reader = sample.reader()
    val lines = reader.readLines()

    val sRow = lines[0]
    val tCol = lines[1]

    val match = 0
    val mismatch = 0
    val gap = 5

    val linear = AlignmentLinearSpace(match, mismatch, gap, useBLOSUM62 = true)

    val result = linear.alignmentLinearSpace(sRow, tCol)
    println(result.first)

    println("---- REVERSE THESE in the ANSWER ---" )
    println(result.second)
    println(result.third)

}


